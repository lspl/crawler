## 起点小说信息

**目标**：爬取起点中文网“全部作品”的前100页信息（https://www.qidian.com/all），包括url, 小说名，作者，类型，完成情况，标签，摘要，字数

直接上版本1.0

```python
# -*- coding: utf-8 -*-
# 2018/4/6 21:37

import requests
import xlwt
import time
from lxml import etree

headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3371.0 Safari/537.36'
}


def get_info(url0):
    res = requests.get(url0, headers=headers)
    selector = etree.HTML(res.text)
    infos = selector.xpath('//li[@data-rid]')
    info_list = []
    for info in infos:
        url1 = 'https:' + info.xpath('div[2]/h4/a/@href')[0]
        name = info.xpath('div[2]/h4/a/text()')[0]
        author = info.xpath('div[2]/p/a/text()')[0]
        type0 = info.xpath('div[2]/p/a[2]/text()')[0] + '.' + info.xpath('div[2]/p/a[3]/text()')[0]
        status = info.xpath('div[2]/p/span/text()')[0]
        tag = ''
        try:
            tag = info.xpath('div[2]/p/a[4]/text()')[0]
        except IndexError:
            pass
        words = info.xpath('div[2]/p[3]/span/span/text()')[0] + '万字'
        abstract = info.xpath('div[2]/p[2]/text()')[0].strip()
        info_list.append([url1, name, author, type0, status, tag, words, abstract])
    return info_list


if __name__ == '__main__':
    book = xlwt.Workbook(encoding='utf-8')
    sheet = book.add_sheet('Sheet1')
    title = ['url', 'name', 'author', 'type', 'status', 'tag', 'words', 'abstract']
    i = 0
    for h in range(len(title)):
        sheet.write(i, h, title[h])
    i = i + 1
    urls = ['https://www.qidian.com/all?orderId=&style=1&pageSize=20&siteid=1&pubflag=0&hiddenField=0&page={}'.format(
        str(i)) for i in range(1, 100)]
    for k in range(0, len(urls)):
        info0 = get_info(urls[k])
        for info in info0:
            for l in range(len(info)):
                sheet.write(i, l, info[l])
            i = i + 1
        time.sleep(1)
        print(k)
        k = k + 1
    book.save('temp.xls')
```

